apiVersion: v1
kind: Namespace
metadata:
    name: arc-runners
    annotations:
        kustomize.config.k8s.io/behavior: merge
sops:
    age:
        - recipient: age152ek83tm4fj5u70r3fecytn4kg7c5xca24erjchxexx4pfqg6das7q763l
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSAwbDBJM0F3em1tVCtKNTdy
            MENEYk52K2dRQ0p6ZHFCYXNidktFOGdadzFjCmhUWG5BTE8wWFltYTdzT1hIZmY2
            MHM1ejA0ckdFUVZjWWYxU0pXMzNVZVkKLS0tIHVqSEo4MStKL0tjSHdhTXFBcjFO
            L1dVQW9WODBGWUpvL00xWE9hK1B1SFUKY7y80019V+3Hg3xi3nMHp32dwh32D28i
            5ErMl32hZ9uYsyofHANDg+I9GAHleo9FoksMh4GHNX3IT4LepgQSMg==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-06-08T18:36:10Z"
    mac: ENC[AES256_GCM,data:ICN28fCc0L2O9eyqtxHHfQLM4V3d7g7mYUsUnI2o8MyyI+O+Q7XFRkpjJSmXIoPi1B6S7sPxiPj4GLOizxnR1K9aKnUmQ6onekU8xfj/VeodIB2kkbk1nuVcE509KOBqjtWjHqLrll1vi3ZsIQolUQVXqaDAf60l2Gx+09f6CT4=,iv:7lxAEuWZcbXwCxYwbMbN/qGAdW2VOvQ28lBTdrwdMkQ=,tag:wG5Ii4/Kct64i9WW7h82gA==,type:str]
    encrypted_regex: ^(github_token)$
    version: 3.10.2
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: arc-runner-set
    namespace: openshift-gitops
    annotations:
        kustomize.config.k8s.io/behavior: replace
spec:
    syncPolicy:
        automated:
            prune: false
            selfHeal: true
    project: default
    source:
        chart: gha-runner-scale-set
        repoURL: ghcr.io/actions/actions-runner-controller-charts
        targetRevision: 0.11.0
        helm:
            releaseName: arc
            valuesObject:
                githubConfigUrl: https://github.com/makeitworkcloud
                githubConfigSecret:
                    github_token: ENC[AES256_GCM,data:fIRx5SaP1JKyJRclltYuuZgZ7H34kx6HwubWyggbBuVbem0jSADXtw==,iv:KcKMld41/Nyt1IX0dxwWYVjEpLJXEX5l4ctD4Hshdmg=,tag:iO9KoV28YtawRjnEA88ynw==,type:str]
                controllerServiceAccount:
                    namespace: arc-systems
                    name: arc-gha-rs-controller
                template:
                    spec:
                        containers:
                            - name: runner
                              image: ghcr.io/actions/actions-runner:latest
                              command:
                                - /home/runner/run.sh
                              securityContext:
                                allowPrivilegeEscalation: false
                                capabilities:
                                    drop:
                                        - ALL
                                runAsNonRoot: true
                                runAsUser: 1001
                                runAsGroup: 123
    destination:
        server: https://kubernetes.default.svc
        namespace: arc-runners
sops:
    age:
        - recipient: age152ek83tm4fj5u70r3fecytn4kg7c5xca24erjchxexx4pfqg6das7q763l
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSAwbDBJM0F3em1tVCtKNTdy
            MENEYk52K2dRQ0p6ZHFCYXNidktFOGdadzFjCmhUWG5BTE8wWFltYTdzT1hIZmY2
            MHM1ejA0ckdFUVZjWWYxU0pXMzNVZVkKLS0tIHVqSEo4MStKL0tjSHdhTXFBcjFO
            L1dVQW9WODBGWUpvL00xWE9hK1B1SFUKY7y80019V+3Hg3xi3nMHp32dwh32D28i
            5ErMl32hZ9uYsyofHANDg+I9GAHleo9FoksMh4GHNX3IT4LepgQSMg==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-06-08T18:36:10Z"
    mac: ENC[AES256_GCM,data:ICN28fCc0L2O9eyqtxHHfQLM4V3d7g7mYUsUnI2o8MyyI+O+Q7XFRkpjJSmXIoPi1B6S7sPxiPj4GLOizxnR1K9aKnUmQ6onekU8xfj/VeodIB2kkbk1nuVcE509KOBqjtWjHqLrll1vi3ZsIQolUQVXqaDAf60l2Gx+09f6CT4=,iv:7lxAEuWZcbXwCxYwbMbN/qGAdW2VOvQ28lBTdrwdMkQ=,tag:wG5Ii4/Kct64i9WW7h82gA==,type:str]
    encrypted_regex: ^(github_token)$
    version: 3.10.2
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
    name: arc-runners-scc-rb
    namespace: arc-runners
    annotations:
        kustomize.config.k8s.io/behavior: merge
roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: ClusterRole
    name: system:openshift:scc:github-arc
subjects:
    - kind: ServiceAccount
      name: arc-runner-set-gha-rs-no-permission
      namespace: arc-runners
sops:
    age:
        - recipient: age152ek83tm4fj5u70r3fecytn4kg7c5xca24erjchxexx4pfqg6das7q763l
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSAwbDBJM0F3em1tVCtKNTdy
            MENEYk52K2dRQ0p6ZHFCYXNidktFOGdadzFjCmhUWG5BTE8wWFltYTdzT1hIZmY2
            MHM1ejA0ckdFUVZjWWYxU0pXMzNVZVkKLS0tIHVqSEo4MStKL0tjSHdhTXFBcjFO
            L1dVQW9WODBGWUpvL00xWE9hK1B1SFUKY7y80019V+3Hg3xi3nMHp32dwh32D28i
            5ErMl32hZ9uYsyofHANDg+I9GAHleo9FoksMh4GHNX3IT4LepgQSMg==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-06-08T18:36:10Z"
    mac: ENC[AES256_GCM,data:ICN28fCc0L2O9eyqtxHHfQLM4V3d7g7mYUsUnI2o8MyyI+O+Q7XFRkpjJSmXIoPi1B6S7sPxiPj4GLOizxnR1K9aKnUmQ6onekU8xfj/VeodIB2kkbk1nuVcE509KOBqjtWjHqLrll1vi3ZsIQolUQVXqaDAf60l2Gx+09f6CT4=,iv:7lxAEuWZcbXwCxYwbMbN/qGAdW2VOvQ28lBTdrwdMkQ=,tag:wG5Ii4/Kct64i9WW7h82gA==,type:str]
    encrypted_regex: ^(github_token)$
    version: 3.10.2
